<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Evento de teatro del Instituto Leopoldo Lugones. Una experiencia teatral única con el mejor elenco.">
    <title>Teatro Instituto Leopoldo Lugones</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Raleway:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    
    <!-- Navegación lateral - Eliminada -->
    <!-- 
    <div class="side-nav">
        <div class="nav-dot active" data-section="hero"></div>
        <div class="nav-dot" data-section="about"></div>
        <div class="nav-dot" data-section="schedule"></div>
        <div class="nav-dot" data-section="footer"></div>
    </div>
    -->

    <!-- Botón de volver arriba -->
    <div class="back-to-top">
        <i class="fas fa-chevron-up"></i>
    </div>

    <!-- Sección Hero -->
    <section id="hero" class="hero-section">
        <div class="hero-content">
            <h1>Acuerdo para cambiar de casa</h1>
            <h2>Una producción de la promo 2025</h2>
            <p class="date">19/11/2025</p>
        </div>
        <div class="scroll-indicator">
            <div class="arrow-container subtle">
                <i class="fas fa-angle-down"></i>
            </div>
            <p class="subtle-text">Desliza</p>
        </div>
    </section>

    <!-- Sección Sobre el Evento -->
    <section id="about" class="about-section">
        <div class="container">
            <h2>Sobre la Obra</h2>
            <div class="about-content">
                <div class="about-text">
                    <p>
                       Obra de Griselda Gambaro que transcurre en un asilo donde el Director intenta convencer a un grupo de internas de mudarse con promesas ambiguas, detonando tensiones y desconfianzas.
                    </p>
                    <p>
                        Griselda Gambaro (nacida en Buenos Aires en 1928) es una novelista y dramaturga argentina, figura fundamental del teatro argentino y latinoamericano, reconocida por su mirada crítica, reflexiva y de vanguardia. Su obra se caracteriza por un "teatro ético" que explora la condición humana, la opresión, la violencia y la incomunicación en las relaciones sociales y familiares, a menudo utilizando la ironía y el grotesco.
                    </p>
                
                    <div class="quote">
                        <blockquote>
                            "El teatro es poesía que se sale del libro para hacerse humana."
                        </blockquote>
                        <cite>— Federico García Lorca</cite>
                    </div>
                
                </div>
                <div class="cast">
                    <h3>Elenco</h3>
                    <ul>
                        Fotos de los actores
                    </ul>
                    <p><strong>Dirección:</strong> Nombre del director</p>
                </div>
            </div>
        </div>
    </section>

  <!-- Elenco (reemplazar solo este bloque) -->
  <section id="elenco" aria-label="Elenco — Acuerdo para cambiar de casa">
    <div class="elenco-header">
      <h2>Elenco</h2>
      <p class="lede">Personajes y Backstage en un carrusel continuo.</p>
    </div>

    <nav class="tabs" role="tablist" aria-label="Secciones">
      <button class="tab" id="tab-personajes" role="tab" aria-selected="true">Personajes</button>
      <button class="tab" id="tab-backstage" role="tab" aria-selected="false">Backstage</button>
    </nav>

    <div class="wrap">
      <div class="rail" id="elenco-rail" tabindex="0" aria-live="polite"></div>
    </div>

    <style>
      #elenco { --panel:#121216; --panel-2:#17171d; --text:#e9e9ee; --muted:#a4a6b0; --stroke:#2a2a33; --accent:#ff8aa6; --radius:18px; --shadow:0 10px 30px rgba(0,0,0,.35); }
      #elenco * { box-sizing: border-box; }

      #elenco .elenco-header { max-width:1100px; margin:28px auto 8px; padding:0 18px; color:var(--text); }
      #elenco .elenco-header h2 { margin:0 0 6px; font-weight:700; font-size:clamp(18px,2.3vw,28px); }
      #elenco .elenco-header .lede { margin:0; color:var(--muted); font-size:clamp(13px,1.6vw,15px); }

      #elenco .tabs { max-width:1100px; margin:18px auto 0; padding:0 18px; display:flex; gap:10px; justify-content:center; }
      #elenco .tab { appearance:none; border:none; background:var(--panel); color:var(--muted); padding:10px 14px; border-radius:12px; cursor:pointer; transition:.2s; box-shadow:inset 0 0 0 1px var(--stroke); }
      #elenco .tab[aria-selected="true"] { background:var(--accent); color:#1a1a1f; font-weight:700; box-shadow:inset 0 0 0 2px rgba(0,0,0,.07); }

      #elenco .wrap { max-width:1100px; margin:16px auto; padding:0 18px; }
      #elenco .rail { display:flex; gap:18px; overflow-x:auto; scroll-snap-type:x mandatory; scroll-behavior:smooth; padding:10px 4px 8px;
                      touch-action:pan-x; -webkit-overflow-scrolling:touch; overscroll-behavior-x:contain; }
      /* centrado mejor en móvil */
      #elenco .rail { padding-left: max(12px, (100% - 360px)/2); padding-right: max(12px, (100% - 360px)/2); }
      #elenco .rail { scrollbar-width:none; -ms-overflow-style:none; }
      #elenco .rail::-webkit-scrollbar { display:none; }
      #elenco .rail.dragging { cursor:grabbing; user-select:none; scroll-behavior:auto; }

      #elenco .card { background:linear-gradient(180deg,var(--panel) 0%,var(--panel-2) 100%); border-radius:var(--radius); box-shadow:var(--shadow);
                      padding:14px; min-width:clamp(260px,78vw,360px); max-width:360px; scroll-snap-align:center; border:1px solid var(--stroke); color:var(--text); }
      #elenco .title { margin:10px 2px 0; font-weight:700; font-size:15px; }
      #elenco .subtitle { margin:2px 2px 0; color:var(--muted); font-size:12px; }

      #elenco .collage { display:grid; grid-template-columns:2fr 1fr; grid-template-rows:1fr 1fr; gap:10px; height:clamp(170px,40vw,220px); }
      #elenco .collage .big { grid-row:1/3; grid-column:1/2; }
      #elenco .frame { position:relative; border-radius:14px; overflow:hidden; background:#0f0f14; border:1px solid var(--stroke); }
      #elenco .frame img { width:100%; height:100%; object-fit:cover; object-position:center center; display:block; }
      #elenco .single { height:clamp(170px,40vw,220px); }
      #elenco .card { scroll-snap-stop: always; }
    </style>

    <script type="module">
      // ==== Utils (nombres desde archivos) ====
      const titleCase = s => (s||'').toString()
        .normalize('NFD').replace(/\p{Diacritic}/gu,'')
        .replace(/[\-_]+/g,' ').replace(/\s+/g,' ').trim()
        .replace(/\b\w/g, ch => ch.toUpperCase());
      const baseFromFilename = fn => {
        const name = (fn||'').split('/').pop().replace(/\.[^.]+$/,'');
        const base = name.split(/[-_\s]?\d+/)[0];
        return titleCase(base);
      };
      // Soporta 'personajes' y 'personajes teatro'
      let BASE_DIR = 'personajes';
      const isUnderAnyBase = (p) => /^(personajes|personajes teatro)\//i.test(p||'');
      const prefixIfNeeded = (p, pref) => {
        if(!p) return p; if(/^https?:\/\//i.test(p)) return p; if(p.startsWith('/')) return p;
        if(isUnderAnyBase(p)) return p;
        return (pref || (BASE_DIR + '/')) + p;
      };
      const backstageCandidates = (p)=>{
        const v = (p||'').replace(/^\/+/, '');
        const list = [];
        const baseName = v.split('/').pop();
        // si ya viene con subcarpeta
        if(/^backstage(\s+teatro)?\//i.test(v)) list.push(v);
        const dirs = [
          BASE_DIR + '/backstage teatro/',
          BASE_DIR + '/Backstage/',
          'backstage teatro/',
          'Backstage/'
        ];
        for(const d of dirs){
          list.push(d + v);
          if(baseName) list.push(d + baseName);
        }
        return Array.from(new Set(list));
      };

      // ==== Estado ====
      let PERSONAJES = [];   // { nombre, fotos:[...] }
      let BACKSTAGES = [];   // { titulo, foto }
      let COMBINED = []; let NP=0, N=0;
      let vIndex = 0; const intervalMs = 4200; let timer = null;

      // ==== DOM ====
      const rail = document.querySelector('#elenco-rail');
      const tabP = document.querySelector('#tab-personajes');
      const tabB = document.querySelector('#tab-backstage');

      const encodePath = (p) => (p||'').split('/').map(s=>encodeURIComponent(s)).join('/');
      const imgTag = (src, alt, onerr) => src
        ? `<img src="${encodePath(src)}" alt="${alt||''}" loading="lazy" ${onerr?`onerror=\"${onerr}\"`:''} />`
        : '';
      const imgWithFallback = (candidates, alt) => {
        const srcs = (candidates||[]).filter(Boolean);
        const first = srcs[0] || '';
        const data = srcs.length > 1 ? ` data-srcs='${JSON.stringify(srcs.slice(1)).replaceAll("'","&apos;")}'` : '';
        return first ? `<img src="${encodePath(first)}" alt="${alt||''}" loading="lazy"${data} />` : '';
      };

      const personCandidates = (v)=>{
        const name = (v||'').replace(/^\/+/, '');
        return [
          BASE_DIR + '/' + name,
          BASE_DIR + '/backstage teatro/' + name
        ];
      };

      function CardPersonaje(p){
        const el = document.createElement('article'); el.className = 'card';
        const fotos = (p.fotos||[]).filter(Boolean);
        let media = '';
        if (fotos.length >= 3) {
          const [f1,f2,f3] = fotos;
          media = `
            <div class="collage">
              <figure class="frame big">${imgWithFallback(personCandidates(f1), `Foto principal de ${p.nombre}`)}</figure>
              <figure class="frame">${imgWithFallback(personCandidates(f2), `Foto 2 de ${p.nombre}`)}</figure>
              <figure class="frame">${imgWithFallback(personCandidates(f3), `Foto 3 de ${p.nombre}`)}</figure>
            </div>`;
        } else if (fotos.length === 2) {
          const [f1,f2] = fotos;
          media = `
            <div class="collage">
              <figure class="frame big">${imgWithFallback(personCandidates(f1), `Foto principal de ${p.nombre}`)}</figure>
              <figure class="frame">${imgWithFallback(personCandidates(f2), `Foto 2 de ${p.nombre}`)}</figure>
            </div>`;
        } else if (fotos.length === 1) {
          const [f1] = fotos;
          media = `<figure class="frame single">${imgWithFallback(personCandidates(f1), `Foto de ${p.nombre}`)}</figure>`;
        }
        el.innerHTML = `
          ${media}
          <div class="title">${p.nombre||''}</div>
          <div class="subtitle">Personaje</div>`;
        // attach fallbacks now that elements exist
        el.querySelectorAll('img[data-srcs]').forEach(img=>{
          img.onerror = function(){
            try{
              const rest = JSON.parse(this.getAttribute('data-srcs')||'[]');
              const next = rest.shift();
              if(next){ this.setAttribute('data-srcs', JSON.stringify(rest)); this.src = encodePath(next); return; }
            }catch{}
            this.onerror = null;
          };
        });
        return el;
      }
      function CardBackstage(b){
        const el = document.createElement('article'); el.className = 'card';
        const srcs = backstageCandidates(b.foto||'');
        const first = srcs[0] || '';
        el.innerHTML = `
          <figure class="frame single">${imgTag(first, b.titulo)}</figure>
          <div class="title">${b.titulo||''}</div>
          <div class="subtitle">Backstage</div>`;
        const img = el.querySelector('img');
        if (img && srcs.length > 1) {
          img.dataset.fallbacks = JSON.stringify(srcs.slice(1));
          img.onerror = function(){
            try{
              const rest = JSON.parse(this.dataset.fallbacks||'[]');
              const next = rest.shift();
              if(next){ this.dataset.fallbacks = JSON.stringify(rest); this.src = encodePath(next); return; }
            }catch{}
            this.onerror = null;
          };
        }
        return el;
      }
      const buildCard = (it) => it.type==='personaje' ? CardPersonaje(it.data) : CardBackstage(it.data);

      function rebuildCombined(){
        COMBINED = [
          ...PERSONAJES.map(p => ({ type:'personaje', data:p })),
          ...BACKSTAGES.map(b => ({ type:'backstage', data:b })),
        ];
        NP = PERSONAJES.length; N = COMBINED.length;
      }

      // ==== Render / scroll infinito ====
      const virtualToReal = vi => vi + 1; // por clon inicial

      function goToReal(realIndex, smooth=true){
        const cards = Array.from(rail.children); if(!cards.length) return;
        const t = cards[realIndex]; if(!t) return;
        const left = t.offsetLeft - (rail.clientWidth - t.clientWidth)/2;
        rail.scrollTo({ left, behavior: smooth ? 'smooth' : 'auto' });
      }
      function goToVirtual(vi, smooth=true){ goToReal(virtualToReal(vi), smooth); }
      function updateTabs(){
        const isP = (NP > 0) && (vIndex < NP);
        tabP.setAttribute('aria-selected', String(isP));
        tabB.setAttribute('aria-selected', String(!isP));
      }

      function render(){
        rail.innerHTML = ''; if(N===0) return;
        rail.appendChild(buildCard(COMBINED[N-1]));           // clon izq
        COMBINED.forEach(it => rail.appendChild(buildCard(it))); // reales
        rail.appendChild(buildCard(COMBINED[0]));             // clon der
        requestAnimationFrame(()=> goToVirtual(vIndex, false));
        updateTabs();
      }

      function next(){ vIndex < N-1 ? (vIndex++, goToVirtual(vIndex)) : goToReal(N+1); updateTabs(); }
      function prev(){ vIndex > 0   ? (vIndex--, goToVirtual(vIndex)) : goToReal(0);   updateTabs(); }
      const startAuto=()=>{ stopAuto(); timer=setInterval(next, intervalMs); };
      const stopAuto =()=>{ if(timer){ clearInterval(timer); timer=null; } };

      tabP.addEventListener('click', ()=>{ vIndex=0;  goToVirtual(vIndex); updateTabs(); stopAuto(); startAuto(); });
      tabB.addEventListener('click', ()=>{ vIndex = (NP < N ? NP : 0); goToVirtual(vIndex); updateTabs(); stopAuto(); startAuto(); });

      // Swipe/drag: usa drag sólo con mouse; en touch deja scroll nativo
      let isDrag=false, startX=0, startLeft=0, startT=0; const SWIPE_MIN=60; const SWIPE_V=0.5; // px/ms
      rail.addEventListener('pointerdown', e=>{ if(e.pointerType==='mouse'){ isDrag=true; startX=e.clientX; startLeft=rail.scrollLeft; startT=performance.now(); rail.classList.add('dragging'); rail.style.scrollSnapType='none'; try{ rail.setPointerCapture(e.pointerId);}catch{} } stopAuto(); });
      rail.addEventListener('pointermove', e=>{ if(!isDrag) return; rail.scrollLeft = startLeft - (e.clientX - startX); });
      function endDrag(e){ if(!isDrag) return; isDrag=false; const dt=performance.now()-startT; const dx=e.clientX-startX; rail.classList.remove('dragging'); rail.style.scrollSnapType='x mandatory'; try{ rail.releasePointerCapture(e.pointerId);}catch{} if(Math.abs(dx)>SWIPE_MIN || Math.abs(dx/dt)>SWIPE_V){ dx<0? next(): prev(); } else { onScrollStop(); } startAuto(); }
      rail.addEventListener('pointerup', endDrag); rail.addEventListener('pointercancel', endDrag); rail.addEventListener('pointerleave', endDrag);

      // Debounce scroll para ajustar clones sin salto
      let scrollTimer=null;
      function onScrollStop(){
        const cards=Array.from(rail.children); if(!cards.length) return;
        const center=rail.scrollLeft+rail.clientWidth/2; let closest=0,delta=Infinity;
        for(let i=0;i<cards.length;i++){ const c=cards[i]; const d=Math.abs((c.offsetLeft+c.clientWidth/2)-center); if(d<delta){delta=d; closest=i;} }
        if(closest===0){ vIndex=N-1; goToVirtual(vIndex,false); }
        else if(closest===N+1){ vIndex=0; goToVirtual(vIndex,false); }
        else { vIndex=closest-1; }
        updateTabs();
      }
      rail.addEventListener('scroll', ()=>{ if(scrollTimer) clearTimeout(scrollTimer); scrollTimer=setTimeout(onScrollStop,80); });
      // pausar/reanudar auto en touch
      rail.addEventListener('touchstart', stopAuto, { passive:true });
      rail.addEventListener('touchend', ()=>{ startAuto(); }, { passive:true });
      window.addEventListener('resize', ()=> goToVirtual(vIndex,false));

      // ==== Datos ====
      // Para GitHub Pages (/teatro-web) usar rutas RELATIVAS sin slash inicial
      async function loadFromManifest(){
        const urls=[
          'personajes/elenco.manifest.json',
          'personajes teatro/elenco.manifest.json',
          'elenco.json'
        ];
        for(const url of urls){
          try{
            const r=await fetch(url,{cache:'no-store'});
            if(r.ok){
              const data=await r.json();
              if(Array.isArray(data.personajes)&&Array.isArray(data.backstages)){
                // Detectar base según el manifest usado
                if(url.startsWith('personajes teatro/')) BASE_DIR = 'personajes teatro';
                else if(url.startsWith('personajes/')) BASE_DIR = 'personajes';
                PERSONAJES = data.personajes.map(p=>({
                  nombre: p.nombre || baseFromFilename(p.fotos?.[0]||''),
                  fotos: (p.fotos||[])
                }));
                BACKSTAGES = data.backstages.map(b=>({
                  titulo: b.titulo || baseFromFilename(b.foto||''),
                  foto:   (b.foto||'')
                }));
                return true;
              }
            }
          }catch{}
        }
        return false;
      }

      function loadFallback(){
        // Si no hay manifiesto, podés completar manualmente:
        PERSONAJES = [
          // ejemplo: { nombre:'Aurora', fotos:['personajes/aurora1.jpeg','personajes/aurora2.jpeg','personajes/aurora3.jpeg'] }
        ];
        BACKSTAGES = [
          // ejemplo: { titulo:'Backstage 1', foto:'personajes/Backstage/Backstage 1.JPG' }
        ];
      }

      (async function init(){
        let ok = await loadFromManifest();
        if(!ok) loadFallback();
        rebuildCombined();
        try { console.log('[Elenco] counts:', { personajes: PERSONAJES.length, backstages: BACKSTAGES.length, total: N, NP }); } catch {}
        render(); startAuto();
      })();
    </script>
  </section>

    <!-- Sección Horarios y Ubicación -->
    <section id="schedule" class="schedule-section">
        <div class="container">
            <h2>Horarios y Ubicación</h2>
            <div class="schedule-content">
                <div class="schedule-table">
                    <h3><i class="far fa-calendar-alt"></i> Funciones</h3>
                    <table>
                        <tr>
                            <th>Día</th>
                            <th>Horario</th>
                        </tr>
                        <tr>
                            <td>19/11</td>
                            <td>20:00 hs</td>
                        </tr>
                    </table>
                </div>
                <div class="location">
                    <h3><i class="fas fa-map-marker-alt"></i> Ubicación</h3>
                    <p>Casa de la cultura</p>
                    <p>calle 1</p>
                    <p>Ordoñez, Unión, Cba</p>
                    <div class="map-container">
  <iframe
    src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3352.0846327036797!2d-62.86779032498146!3d-32.84301076666068!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x95ceaafc508f986d%3A0xd3c870ac39796b6e!2sCasa%20De%20La%20Cultura!5e0!3m2!1ses!2sar!4v1762954925249!5m2!1ses!2sar"
    width="100%"
    height="300"
    style="border:0;"
    allowfullscreen=""
    loading="lazy"
    referrerpolicy="no-referrer-when-downgrade">
  </iframe>
</div>
               
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer id="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <h3>Promo 2025</h3>
                    <p>Ordoñez, Unión, Cba</p>
                </div>
                
                <div class="footer-social">
                    <a href="https://www.instagram.com/promo25_ord/" target="_blank" rel="noopener" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; Promo 2025. Todos los derechos reservados.</p>
            </div>
        </div>
    </footer>

    <script src="js/main.js"></script>
</body>
</html>
